from django.db import models

#List of all dlls
class DllList(models.Model):
    id = models.IntegerField(primary_key=True)
    name = models.CharField(default="", max_length=100)
    def __str__(self):
        return "{} : {}".format(self.id, self.name)

class OpCodeList(models.Model):
    id = models.IntegerField(primary_key=True)
    instruction = models.CharField(default="", max_length=10)
    def __str__(self):
        return "{} : {}".format(self.id, self.instruction)

class StringList(models.Model):
    id = models.IntegerField(primary_key=True)
    string = models.CharField(default="", max_length=250)
    def __str__(self):
        return "{} : {}".format(self.id, self.string)

class EntryFile(models.Model):
    hashMd5 = models.CharField(max_length=32)
    hashSha256 = models.CharField(max_length=64)
    malware = models.BooleanField(default=False)
    #Entropy varies btween 0 and 8
    dataSectionEntropy = models.DecimalField(default=0, max_digits=7, decimal_places=6)
    textSectionEntropy = models.DecimalField(default=0, max_digits=7, decimal_places=6)
    def __str__(self):
        return "FileHashs - ({} : {}) | Entropy - ({} : {})".format(self.hashMd5, self.hashSha256, self.dataSectionEntropy, self.textSectionEntropy)
