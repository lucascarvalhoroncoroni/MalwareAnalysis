from django.db import models

#List of all dlls
class DllList(models.Model):
    id = models.IntegerField(primary_key=True)
    name = models.CharField(default="", max_length=100)
    def __str__(self):
        return "{} : {}".format(self.id, self.name)

#Table that relates Dll to EntryFile
class DllToEntry(models.Model):
    id_dll = models.IntegerField(default=0)
    id_entry = models.IntegerField(default=0)
    def __str__(self):
        return "{} - {}".format(self.id_dll, self.id_entry)

#List of all opcodes
class OpcodeList(models.Model):
    id = models.IntegerField(primary_key=True)
    instruction = models.CharField(default="", max_length=10)
    def __str__(self):
        return "{} : {}".format(self.id, self.instruction)

#Table that relates opcode to EntryFile
class OpcodeToEntry(models.Model):
    id_entry = models.IntegerField(default=0)
    id_opcode = models.IntegerField(default=0)
    porcentage = models.FloatField(default=0)
    def __str__(self):
        return "{} - {} : {}".format(self.id_entry, self.id_opcode, self.porcentage)

#List of all strings
class StringList(models.Model):
    id = models.IntegerField(primary_key=True)
    string = models.CharField(default="", max_length=250)
    def __str__(self):
        return "{} : {}".format(self.id, self.string)

#Table that relates string to EntryFile
class StringToEntry(models.Model):
    id_string = models.IntegerField(default=0)
    id_entry = models.IntegerField(default=0)
    def __str__(self):
        return "{} - {}".format(self.id_string, self.id_entry)

#Table of entry files
class EntryFile(models.Model):
    id = models.IntegerField(primary_key=True)
    hashMd5 = models.CharField(max_length=32)
    hashSha256 = models.CharField(max_length=64)
    malware = models.BooleanField(default=False)
    #Entropy varies btween 0 and 8
    dataSectionEntropy = models.DecimalField(default=0, max_digits=7, decimal_places=6)
    textSectionEntropy = models.DecimalField(default=0, max_digits=7, decimal_places=6)
    def __str__(self):
        return "ID ({}) - FileHashs - ({} : {}) | Entropy - ({} : {})".format(self.id, self.hashMd5, self.hashSha256, self.dataSectionEntropy, self.textSectionEntropy)
