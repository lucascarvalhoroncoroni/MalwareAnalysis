from tools import *
import sys

def main():
    if len(sys.argv) == 2:
        f = PEHandle(sys.argv[1])
        fileHashs = HashTable(sys.argv[1])
        opcodes = OpcodeFile(sys.argv[1])
        strings = Strings(sys.argv[1])
        print('Dlls do arquivo')
        print(f.dlls)
        print('Numero total de dlls : {}'.format(len(f.dlls)))
        print()
        print('Hashs do arquivo')
        print('MD5 : {}'.format(fileHashs.getHashMd5()))
        print('SHA256 : {}'.format(fileHashs.getHashSha256()))
        print()
        print('Primeiros 10 opcodes')
        print(opcodes.getOpcodes()[:10])
        print('Numero total de opcodes: {}'.format(opcodes.getCount()))
        print()
        print('Primeiras 10 Strings')
        print(strings.strings[:10])
        print('Numero total de strings: {}'.format(strings.getCount()))
    else:
        print('Define a exec')
        exit()

if __name__ == '__main__':
    main()
