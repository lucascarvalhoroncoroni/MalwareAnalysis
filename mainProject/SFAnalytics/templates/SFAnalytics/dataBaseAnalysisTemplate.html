{% load staticfiles %}
<!DOCTYPE html>
<html lang"en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.min.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/uploadDataBaseStyle.css' %}"/>
    </head>
    <body>
        <div id="Tabs">
            <ul class="nav nav-tabs">
                <li><a href="http://127.0.0.1:8000/SFAnalytics/uploadDataBase/">DataBase</a></li>
                <li><a href="http://127.0.0.1:8000/SFAnalytics/upload/">Analysis</a></li>
                <li class="active pull-right"><a href="http://127.0.0.1:8000/SFAnalytics/dataBaseAnalysis/">Machine Learning</a></li>
                <li class="pull-right"><a href="http://127.0.0.1:8000/SFAnalytics/searchDataBase/">Search in DataBase</a></li>
            </ul>
        </div>
        <!--This is the Header section, it uses a jumbotron with a blue backgroud(jumbo-color) at uploadStyle.css-->
        <div id="Header" class="jumbotron text-center jumbo-color">
        </div>
        <div id="Body" class="container">
            <!--The well is like a jumbotron but it's smaller-->
            <div class="container">
                <div class="panel panel-primary">
                    <div class="panel-heading">Data Base Learning Results</div>
                    <div class="panel-body">
                        <div class="col-lg-5 col-lg-offset-3">
                            <canvas id="PrecisionChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="container">
                <div class="panel panel-primary">
                    <div class="panel-heading">Data Analysis</div>
                    <div class="panel-body">
                        <div class="col-lg-5">
                            <canvas id="TSNEchart"></canvas>
                        </div>
                        <div class="col-lg-5 col-lg-offset-2">
                            <canvas id="PCAchart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="container">
                <div class="panel panel-primary">
                    <div class="panel-heading">Tree view</div>
                    <div class="panel-body">
                        <div class="thumbnail">
                            <img id="decisionTree" src="{% static 'img/tree.png' %}" class="image-size" alt="Smiley face">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="{% static 'js/Chart.js' %}"></script>
        <script>
            //Making the TSNE chart
            malwareTSNE = {{malwareTSNE | safe}}
            malwareTSNEDataSet = [];
            for(i = 0; i < malwareTSNE.length; i++){
                    malwareTSNEDataSet.push({x : malwareTSNE[i][0], y : malwareTSNE[i][1]})
            }

            softwareTSNE = {{softwareTSNE | safe}}
            softwareTSNEDataSet = []
            for(i = 0; i < softwareTSNE.length; i++){
                    softwareTSNEDataSet.push({x : softwareTSNE[i][0], y : softwareTSNE[i][1]})
            }

            var scatterChartData = {
                datasets:
                    [{
                        label : 'Software',
                        data: malwareTSNEDataSet,
                        //backgroundColor: '#4286f4',
                        borderColor: '#193FFF',
                        backgroundColor: 'rgba(25, 63, 255, 0.55)'
                    },
                    {
                        label : 'Malware',
                        data  : softwareTSNEDataSet,
                        //backgroundColor: '#fc3737',
                        borderColor: '#FF191D',
                        backgroundColor: 'rgba(255, 25, 29, 0.60)'
                    }]
            };

            var tSNEChart = document.getElementById('TSNEchart').getContext('2d');
            var tSNEChartLineChart = new Chart(tSNEChart, {
                type: 'scatter',
                // The data for our dataset
                data : scatterChartData,
                // Configuration options go here
                options: {
                    title: {
                        display: true,
                        text: 't-SNE'
                    }
                }
            });

            //Making the PCA chart
            malwarePCA = {{malwarePCA | safe}}
            malwarePCADataSet = [];
            for(i = 0; i < malwarePCA.length; i++){
                    malwarePCADataSet.push({x : malwarePCA[i][0], y : malwarePCA[i][1]})
            }

            softwarePCA = {{softwarePCA | safe}}
            softwarePCADataSet = []
            for(i = 0; i < softwarePCA.length; i++){
                    softwarePCADataSet.push({x : softwarePCA[i][0], y : softwarePCA[i][1]})
            }

            var scatterChartData = {
                datasets:
                    [{
                        label : 'Software',
                        data: softwarePCADataSet,
                        //backgroundColor: '#4286f4',
                        borderColor: '#193FFF',
                        backgroundColor: 'rgba(25, 63, 255, 0.55)'
                    },
                    {
                        label : 'Malware',
                        data  : malwarePCADataSet,
                        //backgroundColor: '#fc3737',
                        borderColor: '#FF191D',
                        backgroundColor: 'rgba(255, 25, 29, 0.60)'
                    }]
            };

            var pCAchart = document.getElementById('PCAchart').getContext('2d');
            var pCAchartLineChart = new Chart(pCAchart, {
                type: 'scatter',
                // The data for our dataset
                data : scatterChartData,
                // Configuration options go here
                options: {
                    title: {
                        display: true,
                        text: 'PCA'
                    }
                }
            });

            var precision = {{precision | safe}}
            var precisionChart = document.getElementById('PrecisionChart').getContext('2d');
            var precisionBarChart = new Chart(precisionChart, {
                // The type of chart we want to create
                type: 'bar',

                // The data for our dataset
                data: {
                    labels: ['20%','20% to 40%','40% to 60%','60% to 80%','80% to 100%'],
                    datasets: [{
                        label: 'Accuracy',
                        backgroundColor: '#ff9966',
                        borderColor: '#ffbf80',
                        data: precision,
                    }]
                },

                // Configuration options go here
                options: options = {
                                      scales: {
                                        yAxes: [{
                                            scaleLabel: {
                                                display: true,
                                                labelString: 'porcentage (%)'
                                            },
                                            ticks: {
                                                min: 0
                                            }
                                        }]
                                      }
                                  }
            });

        </script>
        <script src="{% static 'js/jquery.min.js' %}"></script>
        <script src="{% static 'js/bootstrap.min.js' %}"></script>
    </body>
</html>
